# bazi-paipan-h5

一个移动端 H5 应用，实现基于用户出生年月日时的八字排盘功能。

## 项目目标

开发一个 移动端 H5 应用，实现基于用户出生年月日时的 八字排盘功能。
用户在首页输入出生信息 → 后端进行排盘计算 → 前端展示大运、流年、十神、藏干等结果。

## 技术栈

- **构建工具**: pnpm
- **前端框架**: Vue3 + Nuxt3
- **样式方案**: UnoCSS（原子化 CSS）
- **组件库**: Vant UI
- **状态管理**: Pinia
- **网络请求**: Nuxt 内置 $fetch
- **后端**: Nuxt3 Server API (`server/api`)
- **数据库**: Prisma + SQLite
- **排盘逻辑**: 基于 `lunar-typescript` 库实现，不使用 mock 数据

## 功能需求

### 首页 (/)

- 用户输入生辰信息：年、月、日必填，时辰可选"未知"
- 使用选择器组件（年、月、日、时辰）+ 提交按钮
- 表单验证（必填，范围正确）
- 点击「排盘」后，调用后端 `/api/pai-pan` 接口，跳转 `/result`

### 结果页 (/result)

- 展示后端计算的八字排盘完整结果，包括：
  - 八字（年柱、月柱、日柱、时柱）
  - 大运
  - 流年
  - 十神
  - 地支藏干
- 布局自适应 H5（移动端优先）
- 支持错误提示 / 重新查询
- 支持通过 ID 回查历史结果（分享链接）

## 变更日志

### 2025-08-19

- **feat**: 初始化项目结构，完成基本的前后端开发。
- **fix**: 修复了从首页跳转到结果页后，页面内容不显示的问题。
  - **原因**: `result.vue` 页面尝试访问 API 响应中不存在的 `solar`, `lunar`, `gender` 字段，导致渲染时发生 JavaScript 错误。
  - **解决方案**: 修改 `result.vue`，在渲染基本信息时，优先使用 API 返回的 `result` 对象中的字段，如果不存在，则回退到使用 `Pinia store` 中的 `form` 数据作为备用，确保页面在任何情况下都能正确渲染基本的用户输入信息。同时修正了 `result.vue` 中 `useRoute` 的 `import` 路径，使其符合 Nuxt3 的规范。
